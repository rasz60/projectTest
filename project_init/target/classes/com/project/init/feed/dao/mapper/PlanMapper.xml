<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.init.feed.dao.IDao" >

<insert id="insertPlan" parameterType="com.project.init.feed.dto.PlanDto">
	INSERT INTO test_calendar (plannum, planName, startDate, endDate, theme) VALUES (plannum_seq.NEXTVAL, #{planName}, #{startDate}, #{endDate}, #{theme})
	<selectKey resultType="int" keyProperty="planNum" order="AFTER">
		SELECT plannum_seq.currVal from dual
	</selectKey>
</insert>

<select id="selectPlan" parameterType="int" resultType="com.project.init.feed.dto.PlanDto">
	SELECT * FROM test_calendar WHERE plannum = #{planNum}
</select>



<!-- 
<select id="selectAllPlan" resultType="com.project.init.feed.dto.PlanDto">
	SELECT planNum, planName, startDate, endDate FROM test_calendar	
</select>
 -->
 
<select id="getCalendarEvent" resultType="com.project.init.feed.dto.PlanDto">
	SELECT planId, planName, startDate, endDate, theme FROM plan_test
</select>

<update id="updatePlan" parameterType="com.project.init.feed.dto.PlanDto">
	UPDATE test_calendar 
	SET planName = #{planName}, startDate = #{startDate}, endDate = #{endDate} 
	WHERE planNum = #{planNum}
</update>

<delete id="deletePlan">
	DELETE FROM test_calendar WHERE planNum = #{planNum}
</delete>

<insert id="insertMap" parameterType="com.project.init.feed.dto.PlanDto2">
	INSERT INTO plan_test
	VALUES (plan_test_seq.nextVal, #{planName}, #{startDate}, #{endDate}, #{theme}, #{latitude}, #{longitude}, #{placeName}, #{category}, #{placecount}, #{address})
</insert>


<insert id="insertPlanDt" parameterType="com.project.init.feed.dto.PlanDtDto">
	INSERT INTO plan_dt_test
	VALUES (plan_dt_seq.nextVAL, #{planNum}, #{planDate}, #{placeName}, #{startTime}, #{endTime}, #{transpotation}, #{details})
</insert>




<!-- comment test -->
<insert id="McommentC" parameterType="com.project.init.feed.dto.CommentDto">
	<choose>
		<when test="iNum == 0">
			INSERT INTO comment_test (commentNum, comments, mNum, gNum, iNum)
			VALUES (comment_seq.nextVAL, #{comments}, comment_seq.currVAL, comment_seq.currVAL, 0) 		
		</when>
		
		<when test="iNum == 1">
			INSERT INTO comment_test (commentNum, comments, mNum, gNum, iNum)
			VALUES (comment_seq.nextVAL, #{comments}, #{mNum}, comment_seq.currVAL, 1)
		</when>

		<otherwise>
			INSERT INTO comment_test (commentNum, comments, mNum, gNum, iNum)
			VALUES (comment_seq.nextVAL, #{comments}, #{mNum}, #{gNum}, #{iNum})
		</otherwise>
	</choose>
</insert>

<select id="selectAllComments" resultType="com.project.init.feed.dto.CommentDto">
	SELECT * 
	FROM comment_test 
	ORDER BY mNum ASC, gNum ASC, iNum ASC, commentNum ASC
</select>


</mapper>

